@page "/members"
@using System.Net.Http.Json
@using FlowManager.Shared.DTOs.Requests
@using FlowManager.Shared.DTOs.Responses
@using FlowManager.Shared.DTOs.Responses.User
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using FlowManager.Client.ViewModels
@using FlowManager.Client.Services
@using FlowManager.Client.DTOs

@attribute [Authorize(Roles = "Admin")]

<PageTitle>Members</PageTitle>

<div class="adminButtons">
    <button @onclick="() => _showAddForm = true" class="adminViewUsersButton">+ Add User</button>
</div>

@if (_users.Any())
{
    <ul>
        @foreach (var user in _users)
        {
            <li>
                <span><strong>@user.Name</strong> (@user.Email)</span>
                <div>
                    <button @onclick="() => OpenEditUser(user)">Edit</button>
                </div>
            </li>
        }
    </ul>
}
else
{
    <p class="text-white">No users found.</p>
}

<FlowManager.Client.Components.MembersModals.MembersAddUserModal
    ShowAddForm="@_showAddForm" />

<FlowManager.Client.Components.MembersModals.MembersEditUserModal
    ShowEditForm="@_showEditForm"
    UserToEdit="@_selectedUserToEdit"/>
